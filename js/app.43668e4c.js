(function(e){function t(t){for(var n,r,s=t[0],a=t[1],u=t[2],p=0,d=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(c,r)&&c[r]&&d.push(c[r][0]),c[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,s=1;s<o.length;s++){var a=o[s];0!==c[a]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},c={app:0},i=[];function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=a;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("7a23"),c={class:"app"},i={class:"window"},r=Object(n["e"])("h1",null,"open-api",-1);function s(e,t,o,s,a,u){var l=Object(n["i"])("open-api");return Object(n["g"])(),Object(n["d"])("div",c,[Object(n["e"])("div",i,[r,Object(n["f"])(l)])])}o("b0c0");var a={class:"container"},u={class:"control"},l={key:0,class:"profile"},p=Object(n["e"])("h3",null,"Аккаунт",-1),d=["src"],f={class:"responses"},h={class:"groups"},g=["src"];function b(e,t,o,c,i,r){return Object(n["g"])(),Object(n["d"])("div",a,[Object(n["e"])("div",u,[Object(n["e"])("div",{class:"button",onClick:t[0]||(t[0]=function(){return r.loginVK&&r.loginVK.apply(r,arguments)})},"Login"),Object(n["e"])("div",{class:"button",onClick:t[1]||(t[1]=function(){return r.logoutVK&&r.logoutVK.apply(r,arguments)})},"Logout"),i.profile?(Object(n["g"])(),Object(n["d"])("div",l,[p,Object(n["e"])("img",{src:i.profile.photo_50},null,8,d),Object(n["e"])("span",null,"Имя: "+Object(n["j"])(i.profile.first_name),1),Object(n["e"])("span",null,"Фамилия: "+Object(n["j"])(i.profile.last_name),1)])):Object(n["c"])("",!0)]),Object(n["e"])("div",f,[Object(n["e"])("h1",null,"code: "+Object(n["j"])(i.code),1),Object(n["e"])("div",h,[(Object(n["g"])(!0),Object(n["d"])(n["a"],null,Object(n["h"])(i.groups,(function(e,t){return Object(n["g"])(),Object(n["d"])("div",{key:t,class:"group"},[Object(n["e"])("img",{src:e["photo_50"],alt:""},null,8,g),Object(n["e"])("span",null,Object(n["j"])(e.name),1),Object(n["e"])("span",null,"id: "+Object(n["j"])(e.id),1)])})),128))])])])}o("a15b"),o("d81d"),o("99af"),o("ac1f"),o("466d"),o("4d63"),o("c607"),o("2c3e"),o("25f0"),o("5319");var v={name:"OpenApi",data:function(){return{changedCookie:!1,interval:null,code:null,codeInCookie:"",groups:[],profile:null}},computed:{authorizeUrl:function(){var e={client_id:8152845,display:"popup",redirect_uri:"https://webmacaque.ru/authVk.html",scope:"stories,photos,messages,docs,manage",group_ids:this.groups.map((function(e){var t=e.id;return t})).join(),response_type:"code"};return"https://oauth.vk.com/authorize?client_id=".concat(e.client_id,"&display=").concat(e.display,"&redirect_uri=").concat(e.redirect_uri,"&scope=").concat(e.scope,"&group_ids=").concat(e.group_ids,"&response_type=").concat(e.response_type,"&v=5.131")}},watch:{changedCookie:function(e){e&&(clearInterval(this.interval),this.changedCookie=!1,console.log("Interval Stop"))}},created:function(){this.codeInCookie=this.getCookie("vk_api_code")},mounted:function(){this.initVK()},methods:{initVK:function(){var e=this,t=document.createElement("script");t.src="https://vk.com/js/api/openapi.js?169",t.onload=function(){window.VK.init({apiId:8152845})},document.head.appendChild(t),setTimeout((function(){window.VK.Auth.getLoginStatus((function(t){console.log("VK.Auth.getLoginStatus",t),t.session&&(e.getData(t),e.getCode())}))}),1e3)},loginVK:function(){var e=this;window.VK.Auth.login((function(t){console.log("VK.Auth.login",t),t.session?(console.log("Пользователь успешно авторизовался",t),e.getData(t),e.getCode()):console.log("Пользователь нажал кнопку Отмена в окне авторизации")}),327680)},logoutVK:function(){window.VK.Auth.logout(),this.code=null,this.codeInCookie="",this.groups=[],this.profile=null},getData:function(e){var t=this;this.profile=e.session.user,window.VK.Api.call("groups.get",{filter:"admin",extended:!0,v:"5.131"},(function(e){console.log("VK.Api.call(groups.get)",e),t.groups=e.response.items})),window.VK.Api.call("users.get",{fields:"photo_50",v:"5.131"},(function(e){console.log("VK.Api.call(users.get)",e),t.profile=e.response[0]}))},getCode:function(){var e=this,t=665,o=370,n=screen.width/2-t/2,c=screen.height/2-o/2,i="width=".concat(t,",height=").concat(o,",left=").concat(n,",top=").concat(c),r=open("https://webmacaque.ru/authVk.html","_blank","popup=1,".concat(i));setTimeout((function(){r.postMessage({source:"vk_api",url:e.authorizeUrl}),e.interval=setInterval(e.checkCookie,500),console.log("Interval Start")}),1e3)},checkCookie:function(){console.log("checkCookie");var e=this.getCookie("vk_api_code");e!=this.codeInCookie&&(this.changedCookie=!0,this.code=this.getCookie("vk_api_code"),this.codeInCookie=this.code)},getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([.$?*|{}()[]\/+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}}},j=(o("d98d"),o("6b0d")),O=o.n(j);const m=O()(v,[["render",b]]);var k=m,_={name:"App",components:{"open-api":k}};o("7d80");const w=O()(_,[["render",s]]);var y=w;Object(n["b"])(y).mount("#app")},"7d80":function(e,t,o){"use strict";o("92aa")},"92aa":function(e,t,o){},d98d:function(e,t,o){"use strict";o("fe81")},fe81:function(e,t,o){}});
//# sourceMappingURL=app.43668e4c.js.map